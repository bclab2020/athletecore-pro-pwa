# AthleteCore Pro - AI姿勢分析システム

## 🎯 プロジェクト概要
AI MediaPipeを活用したリアルタイム姿勢分析PWA（Progressive Web App）。アスリートの姿勢・動作分析を提供し、パフォーマンス向上をサポートします。

## 🏆 **最新アップデート（2025年1月）**
- **📸 写真撮影・表示機能の完全実装**
- **🔍 包括的なデバッグシステム**
- **🧪 即座テスト機能の追加**
- **📊 写真データ管理の最適化**

## ✅ 実装完了機能

### 1. **基本PWA機能**
- Progressive Web App対応（マニフェスト、サービスワーカー）
- オフライン対応・ホーム画面へのインストール可能
- レスポンシブデザイン（モバイル最適化）
- セーフエリア対応（iPhone対応）

### 2. **MediaPipe AI姿勢検出**
- **リアルタイム33点骨格ランドマーク検出**
- フロント/バックカメラ切り替え対応
- **高精度姿勢オーバーレイ表示**（骨格線・垂直基準線）
- カメラ映像のミラーリング対応（フロントカメラ）

### 3. **分析機能**
- **Static Analysis（静的姿勢分析）**: ドラマティック10秒カウントダウン付き
- **Dynamic Analysis（動的動作分析）**: AI自動動作検出・15秒録画
- **リアルタイムスクワット検出・カウント**
- **垂直基準線による姿勢偏差測定**（パーセンテージ表示）
- フルスクリーンモード対応

### 4. **📸 写真撮影・保存機能** ✅ **NEW!**
- **分析実行時の自動写真撮影**
- **姿勢オーバーレイ付き写真保存**（骨格線・基準線込み）
- **Base64エンコーディング**によるローカルストレージ保存
- **インテリジェント容量管理**（8MB制限、自動クリーンアップ）
- **フロントカメラ画像の自動正規化**（ミラー効果補正）

### 5. **📊 分析履歴・詳細表示** ✅ **ENHANCED!**
- **日付別グループ化タイムライン表示**
- **高度なフィルタリング機能**（All/Static/Dynamic）
- **📸 写真付き分析詳細ビュー**
- **フルスクリーン写真モーダル**
- **写真ダウンロード・共有機能**
- **詳細なパフォーマンス分析チャート**

### 6. **🔄 写真比較機能** ✅ **NEW!**
- **Before/After写真比較**
- **スコア改善の詳細可視化**
- **進捗分析レポート自動生成**
- **改善度合いの数値化表示**

### 7. **🎵 マルチモーダルフィードバック**
- **多言語音声ガイダンス**（英語、フロントカメラ使用時）
- **Web Audio API高品質効果音**
- **段階的ハプティックフィードバック**（振動パターン）
- **ビジュアルカウントダウン効果**

### 8. **⚽ 競技特化分析**
- **5競技対応**（サッカー、バスケ、野球、卓球、バレー）
- **競技別スコア基準・推奨事項**
- **パフォーマンス指標の競技特化**

## 🔧 技術スタック
- **Frontend**: HTML5, CSS3 (Tailwind), JavaScript (ES6+)
- **AI/ML**: MediaPipe Pose Detection
- **Visualization**: Chart.js (レーダーチャート)
- **Camera**: WebRTC getUserMedia API
- **Storage**: localStorage (写真データ含む)
- **Audio**: Web Speech API, Web Audio API

## 📸 写真機能の詳細

### 撮影タイミング
- **Static Analysis**: 10秒カウントダウン後、自動撮影
- **Dynamic Analysis**: 15秒動作録画終了時、自動撮影

### 写真データ構造
```javascript
{
  imageData: "data:image/jpeg;base64,/9j/4AAQ...", // Base64画像データ
  width: 640,                                      // 画像幅
  height: 480,                                     // 画像高さ
  timestamp: "2025-01-09T12:34:56.789Z",         // 撮影時刻
  hasPoseOverlay: true,                           // 姿勢オーバーレイ有無
  cameraType: "front"                             // カメラタイプ
}
```

### ストレージ管理
- 最大8MB制限
- 古い写真データを優先的に削除
- 容量不足時は写真なしで分析データのみ保存

## 🛠️ **包括的デバッグシステム** ✅ **NEW!**

### **リアルタイムデバッグコマンド**
ブラウザコンソールで以下のコマンドが利用可能：

```javascript
// 📊 分析履歴とデータ状況の詳細確認
debugAnalysisHistory()
// → 写真データの有無、サイズ、エントリ数などを表示

// 📸 写真キャプチャーの包括的状況確認
debugPhotoCapture()
// → 写真付き/なしのエントリ数、サンプル写真データなど

// 📹 カメラとポーズ検出のリアルタイム状態
debugCameraState()
// → ビデオサイズ、準備状況、ポーズ検出状況

// 🧪 特定分析の詳細表示テスト
testAnalysisDetail('analysis_id_here')
// → 指定IDの分析詳細を強制表示

// 🎯 テスト用写真サンプルの即座作成
debugCreatePhotoSample()
// → 写真付きサンプルデータを作成してテスト表示
```

### **ビジュアルデバッグ機能**
- **分析詳細画面**：リアルタイムデバッグ情報セクション
- **写真表示状態**：緑枠（写真有り）/ 黄枠（写真無し）
- **ストレージ使用量**：自動表示・警告システム

## 🐛 **トラブルシューティングガイド**

### 📸 **写真が表示されない場合**
1. **即座確認**: `debugCreatePhotoSample()` でテスト写真を作成
2. **データ確認**: `debugAnalysisHistory()` で写真データの有無を確認
3. **詳細調査**: 分析詳細画面のデバッグ情報セクションを確認
4. **容量確認**: `getStorageUsage()` でストレージ状況を確認

### 🎥 **カメラが動作しない場合**
1. **権限確認**: カメラアクセス権限の許可
2. **状態確認**: `debugCameraState()` でカメラ状態を確認
3. **切り替えテスト**: フロント/バックカメラ切り替えボタンを試行

### 🤖 **MediaPipe読み込みについて**
- **CDN接続の403/401エラー**: MediaPipe内部処理の正常な動作
- **実際の姿勢検出**: エラーメッセージに関わらず正常動作
- **パフォーマンス**: モバイルデバイスでは初回読み込みに時間がかかる場合あり

### 💾 **データ保存問題**
- **localStorage容量**: 8MB制限、自動的に古いデータを削除
- **写真データ優先削除**: 容量不足時は写真付きエントリから削除
- **緊急時**: 写真なしでも分析データは保存継続

## 📱 **動作確認済み環境**
- **モバイル**: Chrome/Safari (iOS 14+/Android 8+)
- **デスクトップ**: Chrome 90+, Safari 14+, Edge 90+
- **PWA機能**: ホーム画面インストール対応
- **カメラ**: フロント/バック切り替え対応
- **オフライン**: 完全オフライン動作可能

## 🚀 **次期実装予定**
- **💾 IndexedDB移行**: 大容量写真データ対応（現在localStorage 8MB制限）
- **🎥 動画撮影機能**: 動作分析の動画保存・再生
- **🧠 AI分析精度向上**: より詳細な姿勢評価アルゴリズム
- **☁️ クラウド同期**: データのバックアップ・復元機能
- **📈 長期進捗追跡**: 月間・年間の改善傾向分析
- **👥 コーチ機能**: 指導者向けの複数選手管理

## 🌟 **使用開始方法**

### **即座体験**
1. **アプリアクセス** → ブラウザでAthleteCore Proを開く
2. **ユーザー登録** → 基本情報を入力
3. **テスト実行** → コンソールで `debugCreatePhotoSample()` を実行
4. **機能確認** → 分析履歴から写真付きエントリを確認

### **本格利用**
1. **Static Analysis** → 10秒カウントダウンで姿勢分析
2. **Dynamic Analysis** → 動作開始で自動録画・スクワット検出
3. **履歴確認** → 撮影された写真付き分析結果を確認
4. **進捗比較** → Before/After写真比較で改善度を確認

## 🏆 **特徴・優位性**
- **🎯 完全PWA**: アプリストア不要、即座利用開始
- **🔒 プライバシー重視**: 全データローカル保存、外部送信なし
- **📸 高品質写真**: 姿勢オーバーレイ付き分析画像
- **🤖 AI精度**: MediaPipeによる業界標準レベル検出
- **⚡ 高速動作**: リアルタイム処理、遅延最小化
- **🌍 多言語対応**: 日本語・英語デュアル表示

## 📞 **サポート・問い合わせ**
- **技術サポート**: 開発者コンソールのデバッグ機能を活用
- **フィードバック**: GitHub Issues またはお問い合わせフォーム
- **更新情報**: PWA自動更新通知

## 📄 **ライセンス**
MIT License - 商用利用可能

---

**🏃‍♂️ AthleteCore Pro** - 次世代のAI姿勢分析システム  
**Empowering Athletes with AI-Driven Posture Intelligence**

© 2025 bclab.jp. All rights reserved.
